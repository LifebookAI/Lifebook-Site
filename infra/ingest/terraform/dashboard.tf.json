{
  "resource": {
    "aws_cloudwatch_dashboard": {
      "Lifebook_Ingest_Overview": {
        "tags": {
          "Project": "lifebook",
          "Env": "prod"
        },
        "dashboard_body": "{\r\n  \"widgets\": [\r\n    {\r\n      \"type\": \"alarm\",\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 24,\r\n      \"height\": 4,\r\n      \"properties\": {\r\n        \"title\": \"Ingest - INCIDENT (composite)\",\r\n        \"alarms\": [\r\n          \"arn:aws:cloudwatch:us-east-1:354630286254:alarm:lifebook-ingest-incident\"\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      \"type\": \"alarm\",\r\n      \"x\": 0,\r\n      \"y\": 4,\r\n      \"width\": 24,\r\n      \"height\": 4,\r\n      \"properties\": {\r\n        \"title\": \"Ingest - component alarms\",\r\n        \"alarms\": [\r\n          \"arn:aws:cloudwatch:us-east-1:354630286254:alarm:lifebook-ingest-quiet-15m\",\r\n          \"arn:aws:cloudwatch:us-east-1:354630286254:alarm:lifebook-ingest-errors-5m\",\r\n          \"arn:aws:cloudwatch:us-east-1:354630286254:alarm:lifebook-ingest-throttles-5m\"\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      \"type\": \"metric\",\r\n      \"x\": 0,\r\n      \"y\": 8,\r\n      \"width\": 24,\r\n      \"height\": 8,\r\n      \"properties\": {\r\n        \"view\": \"timeSeries\",\r\n        \"stacked\": false,\r\n        \"region\": \"us-east-1\",\r\n        \"title\": \"lifebook-ingest - Invocations / Errors / Throttles (Sum, 60s)\",\r\n        \"metrics\": [\r\n          [\r\n            \"AWS/Lambda\",\r\n            \"Invocations\",\r\n            \"FunctionName\",\r\n            \"lifebook-ingest\",\r\n            {\r\n              \"stat\": \"Sum\",\r\n              \"period\": 60\r\n            }\r\n          ],\r\n          [\r\n            \"AWS/Lambda\",\r\n            \"Errors\",\r\n            \"FunctionName\",\r\n            \"lifebook-ingest\",\r\n            {\r\n              \"stat\": \"Sum\",\r\n              \"period\": 60\r\n            }\r\n          ],\r\n          [\r\n            \"AWS/Lambda\",\r\n            \"Throttles\",\r\n            \"FunctionName\",\r\n            \"lifebook-ingest\",\r\n            {\r\n              \"stat\": \"Sum\",\r\n              \"period\": 60\r\n            }\r\n          ]\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      \"type\": \"log\",\r\n      \"x\": 0,\r\n      \"y\": 16,\r\n      \"width\": 24,\r\n      \"height\": 7,\r\n      \"properties\": {\r\n        \"region\": \"us-east-1\",\r\n        \"title\": \"lifebook-ingest - recent errors (Logs Insights)\",\r\n        \"query\": \"SOURCE '/aws/lambda/lifebook-ingest' | filter @message like /(?i)(error|exception|fail)/ | fields @timestamp, @message, @logStream | sort @timestamp desc | limit 50\"\r\n      }\r\n    },\r\n    {\r\n      \"type\": \"metric\",\r\n      \"x\": 0,\r\n      \"y\": 0,\r\n      \"width\": 12,\r\n      \"height\": 6,\r\n      \"properties\": {\r\n        \"stat\": \"Average\",\r\n        \"period\": 60,\r\n        \"setPeriodToTimeRange\": false,\r\n        \"sparkline\": false,\r\n        \"region\": \"us-east-1\",\r\n        \"stacked\": false,\r\n        \"view\": \"timeSeries\",\r\n        \"legend\": {\r\n          \"position\": \"bottom\"\r\n        },\r\n        \"metrics\": [\r\n          \"AWS/SQS\",\r\n          \"ApproximateNumberOfMessagesVisible\",\r\n          \"QueueName\",\r\n          \"lifebook-ingest-dlq\"\r\n        ],\r\n        \"title\": \"Ingest DLQ — Visible (1m)\"\r\n      }\r\n    },\r\n    {\r\n      \"type\": \"metric\",\r\n      \"x\": 12,\r\n      \"y\": 0,\r\n      \"width\": 12,\r\n      \"height\": 6,\r\n      \"properties\": {\r\n        \"stat\": \"Maximum\",\r\n        \"period\": 60,\r\n        \"setPeriodToTimeRange\": false,\r\n        \"sparkline\": false,\r\n        \"region\": \"us-east-1\",\r\n        \"stacked\": false,\r\n        \"view\": \"timeSeries\",\r\n        \"legend\": {\r\n          \"position\": \"bottom\"\r\n        },\r\n        \"metrics\": [\r\n          \"AWS/SQS\",\r\n          \"ApproximateAgeOfOldestMessage\",\r\n          \"QueueName\",\r\n          \"lifebook-ingest-dlq\"\r\n        ],\r\n        \"title\": \"Ingest DLQ — OldestAge (1m)\"\r\n      }\r\n    }\r\n  ]\r\n}",
        "dashboard_name": "Lifebook-Ingest-Overview"
      }
    }
  }
}
